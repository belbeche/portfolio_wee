{% extends 'base.html.twig' %}

{% block content %}
<div class="container mt-5">
    <h1 class="mb-4">Liste des demandes de rappel</h1>
    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead class="thead-dark">
                <tr>
                    <th scope="col">
                        <a href="{{ path('back_callback_requests', { sort: 'id', order: sortOrder == 'asc' and sortField == 'id' ? 'desc' : 'asc' }) }}">
                            #
                            {% if sortField == 'id' %}
                                {% if sortOrder == 'asc' %}
                                    &#9650;  {# Flèche vers le haut #}
                                {% else %}
                                    &#9660;  {# Flèche vers le bas #}
                                {% endif %}
                            {% endif %}
                        </a>
                    </th>
                    <th scope="col">
                        <a href="{{ path('back_callback_requests', { sort: 'name', order: sortOrder == 'asc' and sortField == 'name' ? 'desc' : 'asc' }) }}">
                            Nom/Prénom
                            {% if sortField == 'name' %}
                                {% if sortOrder == 'asc' %}
                                    &#9650;
                                {% else %}
                                    &#9660;
                                {% endif %}
                            {% endif %}
                        </a>
                    </th>
                    <th scope="col">
                        <a href="{{ path('back_callback_requests', { sort: 'phone', order: sortOrder == 'asc' and sortField == 'phone' ? 'desc' : 'asc' }) }}">
                            Téléphone
                            {% if sortField == 'phone' %}
                                {% if sortOrder == 'asc' %}
                                    &#9650;
                                {% else %}
                                    &#9660;
                                {% endif %}
                            {% endif %}
                        </a>
                    </th>
                    <th scope="col">
                        <a href="{{ path('back_callback_requests', { sort: 'email', order: sortOrder == 'asc' and sortField == 'email' ? 'desc' : 'asc' }) }}">
                            Email
                            {% if sortField == 'email' %}
                                {% if sortOrder == 'asc' %}
                                    &#9650;
                                {% else %}
                                    &#9660;
                                {% endif %}
                            {% endif %}
                        </a>
                    </th>
                    <th scope="col">
                        <a href="{{ path('back_callback_requests', { sort: 'status', order: sortOrder == 'asc' and sortField == 'status' ? 'desc' : 'asc' }) }}">
                            Statut
                            {% if sortField == 'status' %}
                                {% if sortOrder == 'asc' %}
                                    &#9650;
                                {% else %}
                                    &#9660;
                                {% endif %}
                            {% endif %}
                        </a>
                    </th>
                    <th scope="col">Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for request in callbackRequests %}
                <tr>
                    <th scope="row">{{ loop.index }}</th>
                    <td>{{ request.name }}</td>
                    <td>{{ request.phone }}</td>
                    <td>{{ request.email }}</td>
                    <td>{{ request.status }}</td>
                    <td>
                        <a href="tel:{{ request.phone }}" class="btn btn-secondary btn-sm">Appeler</a>
                        <a href="{{ path('back_callback_request_validate', {id: request.id}) }}" class="btn btn-success btn-sm">Valider</a>
                        <a href="{{ path('back_callback_request_cancel', {id: request.id}) }}" class="btn btn-danger btn-sm">Annuler</a>
                        <a href="{{ path('back_callback_request_relaunch', {id: request.id}) }}" class="btn btn-warning btn-sm">Relancer</a>
                        <form action="{{ path('back_callback_request_remove', {id: request.id}) }}" method="post">
                            <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ request.id) }}">
                            <button type="submit" class="btn btn-primary btn-sm" onclick="return confirm('Êtes-vous sûr de vouloir supprimer ce prospect ?');">Supprimer</button>
                        </form>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="6" class="text-center">Aucune demande de rappel disponible.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
